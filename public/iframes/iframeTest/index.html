<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>

    <style>
      body {
        background-color: lightblue;
      }
    </style>
  </head>
  <body>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas non
      molestie sem. Morbi nisi sapien, pretium at augue ut, eleifend imperdiet
      velit. Fusce vehicula, ante quis ornare euismod, libero nisi fermentum
      ante, dictum egestas sapien dolor quis justo. Proin consectetur orci sed
      urna euismod consectetur. Praesent sollicitudin orci vitae diam imperdiet,
      nec dignissim turpis interdum. Sed quis blandit tellus, quis tristique
      felis. Donec iaculis sem nec urna ultrices imperdiet. Morbi ultrices
      semper lectus ut fermentum. Mauris elementum diam eu diam laoreet, aliquet
      molestie mi cursus. Pellentesque et sapien accumsan, laoreet ex quis,
      hendrerit eros. Proin mauris urna, gravida eget fringilla in, tincidunt
      tempor felis. Maecenas hendrerit maximus nulla eget consectetur. Aenean ac
      mauris vel dui euismod vestibulum in sit amet magna. Sed dapibus gravida
      diam, feugiat auctor felis mollis nec. In porttitor dictum fringilla.
      Vestibulum et purus lorem.
    </p>

    <p>
      Integer bibendum maximus nunc. Morbi pellentesque ligula quis felis
      interdum, id placerat urna suscipit. Integer suscipit, urna at hendrerit
      efficitur, ipsum urna varius nisl, non tristique elit erat non lacus.
      Morbi vel tellus lorem. Quisque ac diam ut felis fermentum aliquet ac id
      felis. Pellentesque efficitur id quam nec semper. Phasellus ornare dapibus
      felis sed commodo. Vivamus accumsan lacus vel metus malesuada, non varius
      nisi porta. Fusce eu egestas nulla, ut maximus lorem. Donec malesuada
      lectus in nulla dapibus, eget pharetra magna egestas. Pellentesque id
      risus a eros maximus pretium sed in dui. Aenean aliquam diam quis eros
      vestibulum rhoncus. Quisque quis ultricies libero, quis pretium mi. Nunc
      venenatis risus ipsum. Phasellus at tincidunt sem, non pharetra odio.
    </p>

    <p>
      Praesent eleifend, turpis quis vehicula pharetra, ex justo sollicitudin
      quam, quis cursus lorem eros in arcu. Nullam pretium est quis volutpat
      vehicula. Aenean vitae eleifend sapien, efficitur tempus massa. Quisque a
      est aliquam, interdum massa a, maximus purus. Etiam nec purus auctor,
      vehicula sem at, tincidunt orci. Sed imperdiet turpis non ex egestas, ut
      dictum nibh placerat. Suspendisse quis mi nunc. Aenean bibendum hendrerit
      dictum. Nunc sagittis ornare lacinia. Donec eleifend arcu at massa porta
      mollis.
    </p>

    <p>
      Aenean vitae scelerisque dolor, non ornare nulla. Sed et malesuada neque,
      nec dictum magna. Ut vulputate blandit euismod. Donec iaculis eleifend ex.
      Maecenas imperdiet vestibulum nisl, sit amet luctus leo placerat porta.
      Cras tincidunt erat nec tellus commodo commodo. Aenean eu ligula varius
      arcu finibus venenatis a ac nunc. Etiam non finibus ante, non scelerisque
      justo. Curabitur a pulvinar mauris. Sed lacus felis, ultricies eget
      gravida a, rutrum at erat. Vivamus imperdiet aliquam justo a posuere. Nunc
      pulvinar enim cursus nisi dignissim, sit amet suscipit ligula imperdiet.
      Aenean libero nisl, sollicitudin quis leo eget, malesuada porttitor ex.
    </p>

    <p>
      Etiam sit amet sem luctus nisl varius sodales sed non turpis. Vestibulum
      nec felis ac lectus semper semper in eget erat. Vestibulum blandit euismod
      lobortis. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices
      posuere cubilia curae; Quisque nec dictum ante, non semper tortor. Nunc
      sit amet purus et nunc interdum accumsan at scelerisque lectus. In
      vulputate nisi nec luctus tristique. Praesent tempor, mauris et gravida
      scelerisque, ipsum lacus efficitur ipsum, eu facilisis nisl dolor in
      neque.
    </p>

    <script>
      function getPageHeight() {
        const body = document.body;
        const html = document.documentElement;

        return Math.max(body.scrollHeight, body.offsetHeight);
      }

      function sendHeightMessage() {
        const height = getPageHeight();
        console.log(`Height of ${height} has been sent to parent.`);
        window.parent.postMessage({
          type: "iframeHeight",
          height,
        });
      }

      // Send once on load
      window.addEventListener("load", sendHeightMessage);

      // Optionally watch for changes
      const observer = new ResizeObserver(sendHeightMessage);
      observer.observe(document.body);

      // Respond if the parent requests height
      window.addEventListener("message", (event) => {
        if (event.data?.type === "getHeight") {
          sendHeightMessage();
        }
      });
    </script>
  </body>
</html>
